{
  "name": "AI市场调研工作流-SiliconFlow版",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "market-research",
        "responseMode": "onReceived",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "接收研究请求",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300],
      "webhookId": "market-research-webhook"
    },
    {
      "parameters": {
        "url": "https://api.siliconflow.cn/v1/chat/completions",
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "jsonParameters": true,
        "parametersJson": "{\n  \"model\": \"deepseek-ai/DeepSeek-V3\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"你是一名顶尖的电商市场分析师。请严格按照要求的JSON格式返回分析结果。\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"请围绕核心主题 \\\"{{ $json[\\\"body\\\"][\\\"topic\\\"] }}\\\" 进行深度市场机会分析。\\n\\n请按照以下结构进行分析，并以JSON格式返回：\\n\\n{\\n  \\\"market_overview\\\": \\\"整体市场概况（200-300字）\\\",\\n  \\\"market_size\\\": \\\"预估市场规模和增长率\\\",\\n  \\\"key_niches\\\": [\\n    {\\n      \\\"niche_name\\\": \\\"细分市场名称\\\",\\n      \\\"target_audience\\\": \\\"目标用户群体\\\",\\n      \\\"pain_point\\\": \\\"核心痛点\\\",\\n      \\\"opportunity_score\\\": \\\"机会评分(1-10)\\\",\\n      \\\"market_trend\\\": \\\"市场趋势描述\\\"\\n    }\\n  ],\\n  \\\"entry_barriers\\\": \\\"进入门槛分析\\\",\\n  \\\"success_factors\\\": [\\\"成功关键因素1\\\", \\\"成功关键因素2\\\", \\\"成功关键因素3\\\"]\\n}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "market-analysis",
      "name": "市场机会分析",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [460, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "siliconflow-api"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.siliconflow.cn/v1/chat/completions",
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "jsonParameters": true,
        "parametersJson": "{\n  \"model\": \"deepseek-ai/DeepSeek-V3\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"你是一名专业的SEO和关键词分析师。请严格按照要求的JSON格式返回分析结果。\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"基于以下市场机会分析结果：{{ $node[\\\"市场机会分析\\\"].json.choices[0].message.content }}\\n\\n请为排名第一的细分市场进行深度关键词和需求分析，以JSON格式返回：\\n\\n{\\n  \\\"primary_niche\\\": \\\"主要细分市场名称\\\",\\n  \\\"core_keywords\\\": [\\n    \\\"高价值关键词1\\\",\\n    \\\"高价值关键词2\\\",\\n    \\\"高价值关键词3\\\",\\n    \\\"高价值关键词4\\\",\\n    \\\"高价值关键词5\\\"\\n  ],\\n  \\\"long_tail_keywords\\\": [\\n    \\\"长尾关键词1\\\",\\n    \\\"长尾关键词2\\\",\\n    \\\"长尾关键词3\\\",\\n    \\\"长尾关键词4\\\",\\n    \\\"长尾关键词5\\\"\\n  ],\\n  \\\"search_intent_analysis\\\": {\\n    \\\"informational\\\": [\\\"信息型搜索词\\\"],\\n    \\\"commercial\\\": [\\\"商业型搜索词\\\"],\\n    \\\"transactional\\\": [\\\"交易型搜索词\\\"]\\n  },\\n  \\\"seasonal_trends\\\": \\\"季节性趋势分析\\\",\\n  \\\"content_opportunities\\\": [\\\"内容营销机会1\\\", \\\"内容营销机会2\\\", \\\"内容营销机会3\\\"]\\n}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "keyword-analysis",
      "name": "关键词需求分析",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [680, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "siliconflow-api"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.siliconflow.cn/v1/chat/completions",
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "jsonParameters": true,
        "parametersJson": "{\n  \"model\": \"deepseek-ai/DeepSeek-V3\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"你是一名专业的竞争情报分析师。请严格按照要求的JSON格式返回分析结果。\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"基于市场分析：{{ $node[\\\"市场机会分析\\\"].json.choices[0].message.content }}\\n\\n请分析该市场的主要竞争对手，以JSON格式返回：\\n\\n{\\n  \\\"competitive_landscape\\\": \\\"竞争格局概述\\\",\\n  \\\"top_competitors\\\": [\\n    {\\n      \\\"name\\\": \\\"竞争对手名称\\\",\\n      \\\"type\\\": \\\"公司类型（大企业/创业公司/品牌商等）\\\",\\n      \\\"market_share\\\": \\\"市场份额估算\\\",\\n      \\\"strengths\\\": [\\\"优势1\\\", \\\"优势2\\\", \\\"优势3\\\"],\\n      \\\"weaknesses\\\": [\\\"劣势1\\\", \\\"劣势2\\\"],\\n      \\\"pricing_strategy\\\": \\\"定价策略\\\",\\n      \\\"differentiation\\\": \\\"差异化优势\\\"\\n    }\\n  ],\\n  \\\"market_gaps\\\": [\\\"市场空白1\\\", \\\"市场空白2\\\", \\\"市场空白3\\\"],\\n  \\\"competitive_advantages\\\": [\\\"可获得的竞争优势1\\\", \\\"可获得的竞争优势2\\\"],\\n  \\\"threat_level\\\": \\\"竞争威胁等级（高/中/低）\\\",\\n  \\\"entry_strategy\\\": \\\"建议的市场进入策略\\\"\\n}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "competitor-analysis",
      "name": "竞争对手分析",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [900, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "siliconflow-api"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.siliconflow.cn/v1/chat/completions",
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "jsonParameters": true,
        "parametersJson": "{\n  \"model\": \"deepseek-ai/DeepSeek-V3\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"你是一名专业的用户研究和数据分析师。请严格按照要求的JSON格式返回分析结果。\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"基于市场分析：{{ $node[\\\"市场机会分析\\\"].json.choices[0].message.content }}\\n关键词分析：{{ $node[\\\"关键词需求分析\\\"].json.choices[0].message.content }}\\n\\n请构建详细的用户画像，以JSON格式返回：\\n\\n{\\n  \\\"primary_persona\\\": {\\n    \\\"name\\\": \\\"主要用户群体名称\\\",\\n    \\\"demographics\\\": {\\n      \\\"age_range\\\": \\\"年龄范围\\\",\\n      \\\"gender\\\": \\\"性别分布\\\",\\n      \\\"income_level\\\": \\\"收入水平\\\",\\n      \\\"education\\\": \\\"教育背景\\\",\\n      \\\"location\\\": \\\"地理分布\\\"\\n    },\\n    \\\"psychographics\\\": {\\n      \\\"interests\\\": [\\\"兴趣1\\\", \\\"兴趣2\\\", \\\"兴趣3\\\"],\\n      \\\"values\\\": [\\\"价值观1\\\", \\\"价值观2\\\"],\\n      \\\"lifestyle\\\": \\\"生活方式描述\\\",\\n      \\\"personality_traits\\\": [\\\"性格特征1\\\", \\\"性格特征2\\\"]\\n    },\\n    \\\"behavior_patterns\\\": {\\n      \\\"purchase_drivers\\\": [\\\"购买动机1\\\", \\\"购买动机2\\\"],\\n      \\\"decision_process\\\": \\\"决策过程描述\\\",\\n      \\\"preferred_channels\\\": [\\\"偏好渠道1\\\", \\\"偏好渠道2\\\"],\\n      \\\"content_preferences\\\": [\\\"内容偏好1\\\", \\\"内容偏好2\\\"]\\n    }\\n  },\\n  \\\"secondary_personas\\\": [\\n    {\\\"name\\\": \\\"次要用户群体\\\", \\\"key_characteristics\\\": \\\"主要特征\\\"}\\n  ],\\n  \\\"user_journey\\\": [\\n    {\\\"stage\\\": \\\"认知阶段\\\", \\\"actions\\\": [\\\"用户行为1\\\", \\\"用户行为2\\\"]},\\n    {\\\"stage\\\": \\\"考虑阶段\\\", \\\"actions\\\": [\\\"用户行为1\\\", \\\"用户行为2\\\"]},\\n    {\\\"stage\\\": \\\"购买阶段\\\", \\\"actions\\\": [\\\"用户行为1\\\", \\\"用户行为2\\\"]}\\n  ]\\n}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "user-persona-analysis",
      "name": "用户画像分析",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "siliconflow-api"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.siliconflow.cn/v1/chat/completions",
        "authentication": "headerAuth",
        "requestMethod": "POST",
        "jsonParameters": true,
        "parametersJson": "{\n  \"model\": \"deepseek-ai/DeepSeek-V3\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"你是一名资深的数字营销策略专家。请严格按照要求的JSON格式返回分析结果。\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"基于以下分析结果制定营销策略：\\n市场分析：{{ $node[\\\"市场机会分析\\\"].json.choices[0].message.content }}\\n关键词分析：{{ $node[\\\"关键词需求分析\\\"].json.choices[0].message.content }}\\n竞争分析：{{ $node[\\\"竞争对手分析\\\"].json.choices[0].message.content }}\\n用户画像：{{ $node[\\\"用户画像分析\\\"].json.choices[0].message.content }}\\n\\n请制定综合营销策略，以JSON格式返回：\\n\\n{\\n  \\\"executive_summary\\\": \\\"策略概述（100-150字）\\\",\\n  \\\"positioning_strategy\\\": {\\n    \\\"value_proposition\\\": \\\"价值主张\\\",\\n    \\\"differentiation\\\": \\\"差异化要点\\\",\\n    \\\"target_message\\\": \\\"核心信息\\\"\\n  },\\n  \\\"marketing_channels\\\": [\\n    {\\n      \\\"channel\\\": \\\"营销渠道名称\\\",\\n      \\\"priority\\\": \\\"高/中/低\\\",\\n      \\\"budget_allocation\\\": \\\"预算分配百分比\\\",\\n      \\\"tactics\\\": [\\\"战术1\\\", \\\"战术2\\\"],\\n      \\\"kpis\\\": [\\\"关键指标1\\\", \\\"关键指标2\\\"]\\n    }\\n  ],\\n  \\\"content_strategy\\\": {\\n    \\\"content_themes\\\": [\\\"内容主题1\\\", \\\"内容主题2\\\", \\\"内容主题3\\\"],\\n    \\\"content_formats\\\": [\\\"内容形式1\\\", \\\"内容形式2\\\"],\\n    \\\"publishing_calendar\\\": \\\"发布频率建议\\\"\\n  },\\n  \\\"implementation_roadmap\\\": [\\n    {\\\"phase\\\": \\\"第一阶段（1-3个月）\\\", \\\"activities\\\": [\\\"活动1\\\", \\\"活动2\\\"]},\\n    {\\\"phase\\\": \\\"第二阶段（4-6个月）\\\", \\\"activities\\\": [\\\"活动1\\\", \\\"活动2\\\"]},\\n    {\\\"phase\\\": \\\"第三阶段（7-12个月）\\\", \\\"activities\\\": [\\\"活动1\\\", \\\"活动2\\\"]}\\n  ],\\n  \\\"success_metrics\\\": [\\\"成功指标1\\\", \\\"成功指标2\\\", \\\"成功指标3\\\"],\\n  \\\"budget_estimate\\\": \\\"预算估算\\\"\\n}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "marketing-strategy",
      "name": "营销策略制定",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1340, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "siliconflow-api"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "mergeByFields": {
          "values": [
            {
              "field1": "market_analysis",
              "field2": "keyword_analysis"
            }
          ]
        },
        "options": {}
      },
      "id": "combine-results",
      "name": "整合分析结果",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [1560, 300]
    },
    {
      "parameters": {
        "jsCode": "// 整合所有AI分析结果为邮件内容\nconst marketAnalysis = $node[\"市场机会分析\"].json.choices[0].message.content;\nconst keywordAnalysis = $node[\"关键词需求分析\"].json.choices[0].message.content;\nconst competitorAnalysis = $node[\"竞争对手分析\"].json.choices[0].message.content;\nconst userPersona = $node[\"用户画像分析\"].json.choices[0].message.content;\nconst marketingStrategy = $node[\"营销策略制定\"].json.choices[0].message.content;\n\nconst topic = $node[\"接收研究请求\"].json.body.topic;\nconst email = $node[\"接收研究请求\"].json.body.email;\n\n// 生成邮件内容\nconst emailContent = `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>AI市场调研报告 - ${topic}</title>\n    <style>\n        body { font-family: 'Microsoft YaHei', Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 20px; }\n        .header { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 10px; text-align: center; margin-bottom: 30px; }\n        .section { background: #f8f9fa; padding: 25px; margin: 20px 0; border-radius: 8px; border-left: 4px solid #667eea; }\n        .section h2 { color: #667eea; margin-top: 0; }\n        .highlight { background: #e3f2fd; padding: 15px; border-radius: 5px; margin: 15px 0; }\n        .footer { text-align: center; margin-top: 40px; padding: 20px; background: #f5f5f5; border-radius: 8px; }\n        .json-content { background: #f8f8f8; padding: 15px; border-radius: 5px; white-space: pre-wrap; font-family: monospace; margin: 10px 0; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>🎯 AI市场调研报告</h1>\n        <p>研究主题: <strong>${topic}</strong></p>\n        <p>生成时间: ${new Date().toLocaleString('zh-CN')}</p>\n    </div>\n\n    <div class=\"section\">\n        <h2>📊 市场机会分析</h2>\n        <div class=\"json-content\">${marketAnalysis}</div>\n    </div>\n\n    <div class=\"section\">\n        <h2>🔍 关键词需求分析</h2>\n        <div class=\"json-content\">${keywordAnalysis}</div>\n    </div>\n\n    <div class=\"section\">\n        <h2>🏆 竞争对手分析</h2>\n        <div class=\"json-content\">${competitorAnalysis}</div>\n    </div>\n\n    <div class=\"section\">\n        <h2>👥 用户画像分析</h2>\n        <div class=\"json-content\">${userPersona}</div>\n    </div>\n\n    <div class=\"section\">\n        <h2>📈 营销策略建议</h2>\n        <div class=\"json-content\">${marketingStrategy}</div>\n    </div>\n\n    <div class=\"footer\">\n        <p>🤖 本报告由AI智能分析生成</p>\n        <p>📧 发送至: ${email}</p>\n        <p>🔬 技术支持: SiliconFlow API + n8n 工作流</p>\n    </div>\n</body>\n</html>\n`;\n\nreturn [{\n  json: {\n    email_content: emailContent,\n    topic: topic,\n    recipient_email: email,\n    subject: `🎯 AI市场调研报告 - ${topic}`,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "id": "generate-email",
      "name": "生成邮件内容",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1780, 300]
    },
    {
      "parameters": {
        "fromEmail": "={{ $vars.SMTP_FROM_EMAIL }}",
        "toEmail": "={{ $node[\"生成邮件内容\"].json.recipient_email }}",
        "subject": "={{ $node[\"生成邮件内容\"].json.subject }}",
        "emailFormat": "html",
        "html": "={{ $node[\"生成邮件内容\"].json.email_content }}",
        "options": {}
      },
      "id": "send-email",
      "name": "发送邮件报告",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [2000, 300],
      "credentials": {
        "smtp": {
          "id": "gmail-smtp"
        }
      }
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-01-12T13:30:00.000Z",
  "versionId": "1",
  "meta": {
    "templateCredsSetupCompleted": false
  }
}